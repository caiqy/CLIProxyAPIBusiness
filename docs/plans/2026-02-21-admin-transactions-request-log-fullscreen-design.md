# 管理员交易日志弹窗全屏化设计

## 背景

当前“最近交易”的请求日志采用居中中等尺寸弹窗（`max-w-5xl`），在长日志场景下可读性不足。需求是改为真全屏展示，并调整失败交互：日志获取失败时不再打开弹窗。

## 目标

1. 请求日志详情使用真全屏弹窗（覆盖整个视口）。
2. 点击日志图标后仅在请求成功时打开弹窗。
3. 请求失败（含日志不存在）时不打开弹窗，改为右上角 toast 提示。
4. 保留现有可访问性与并发防抖能力（Esc、焦点恢复、旧请求不覆盖新请求）。

## 非目标

1. 不改后端接口与错误码语义。
2. 不新增日志结构化解析功能。
3. 不重构为独立通用 Modal 组件。

## 方案选型

### 方案 A：现有弹窗直接全屏化（采用）

- 优点：改动最小、风险低、上线快。
- 代价：Modal 逻辑仍耦合在页面组件内。

### 方案 B：抽象通用 FullscreenModal（未采用）

- 优点：复用性更好。
- 代价：本次需求较小，重构成本偏高。

### 方案 C：保留居中弹窗，仅放大尺寸（未采用）

- 优点：样式改动最少。
- 代价：不能满足“真全屏”诉求。

## 交互设计

1. 点击交易行日志图标后，先发起详情请求。
2. 请求成功：打开全屏弹窗，展示 Request/Response 两栏原文。
3. 请求失败：不打开弹窗，在右上角显示 toast 错误提示。
4. 弹窗支持 Esc 关闭，关闭后焦点回到触发按钮。

## 视觉与布局设计

1. 外层容器：`fixed inset-0 z-50`，覆盖全视口。
2. 弹窗主体：`w-screen h-screen`，移除圆角与外边距。
3. 顶栏固定显示标题与关闭按钮。
4. 内容区滚动，保留双栏（移动端单栏）布局。

## 状态与数据流

1. `openRequestLog` 触发后先清空旧内容并发起请求。
2. 若请求返回成功，写入 request/response 文本并 `setRequestLogOpen(true)`。
3. 若请求失败，写入 toast 错误消息，不变更 `requestLogOpen`。
4. 保持 request id 竞态保护：仅最后一次请求可写入 UI。

## 错误处理

1. 日志不存在（404）：toast 提示“日志不存在”类文案。
2. 服务异常（500）：toast 提示“加载日志失败”类文案。
3. 不在弹窗内展示错误（因为失败时不弹窗）。

## 测试方案

1. 成功路径：点击图标 -> 弹出全屏 dialog -> 展示 Request/Response。
2. 失败路径：点击图标 -> 不出现 dialog -> 出现右上角 toast。
3. 可访问性：dialog 保留 `role/aria`，Esc 关闭与焦点恢复。
4. 并发路径：快速点击多行时，旧请求结果不覆盖最新点击。

## 验收标准

1. 请求日志弹窗为真全屏显示。
2. 日志请求失败时不弹窗，仅 toast 提示。
3. 成功时仍可完整查看双栏原文。
4. 现有可访问性与并发保护能力不回退。
